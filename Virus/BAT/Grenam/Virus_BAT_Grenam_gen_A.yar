
rule Virus_BAT_Grenam_gen_A{
	meta:
		description = "Virus:BAT/Grenam.gen!A,SIGNATURE_TYPE_PEHSTR_EXT,ffffffff 00 ffffffe6 00 06 00 00 64 00 "
		
	strings :
		$a_01_0 = {66 00 75 00 63 00 6b 00 20 00 79 00 6f 00 75 00 21 00 20 00 54 00 68 00 61 00 74 00 27 00 73 00 20 00 77 00 68 00 79 00 } //64 00  fuck you! That's why
		$a_01_1 = {44 00 65 00 76 00 69 00 63 00 65 00 49 00 44 00 2c 00 20 00 4d 00 6f 00 64 00 65 00 6c 00 20 00 66 00 72 00 6f 00 6d 00 20 00 57 00 69 00 6e 00 33 00 32 00 5f 00 44 00 69 00 73 00 6b 00 44 00 72 00 69 00 76 00 65 00 20 00 77 00 68 00 65 00 72 00 65 00 20 00 49 00 6e 00 74 00 65 00 72 00 66 00 61 00 63 00 65 00 54 00 79 00 70 00 65 00 3d 00 27 00 55 00 53 00 42 00 27 00 } //32 00  DeviceID, Model from Win32_DiskDrive where InterfaceType='USB'
		$a_03_2 = {48 00 69 00 64 00 64 00 65 00 6e 00 90 01 02 72 00 75 00 6e 00 61 00 73 00 90 01 02 7b 00 30 00 3a 00 78 00 34 00 7d 00 7b 00 31 00 3a 00 78 00 34 00 7d 00 90 00 } //19 00 
		$a_03_3 = {76 00 73 00 70 00 63 00 6f 00 6e 00 73 00 6f 00 6c 00 65 00 90 01 02 64 00 76 00 6d 00 90 00 } //19 00 
		$a_03_4 = {76 00 73 00 70 00 6d 00 65 00 6d 00 90 01 02 77 00 6d 00 63 00 73 00 70 00 90 01 02 73 00 76 00 63 00 76 00 73 00 70 00 90 00 } //05 00 
		$a_01_5 = {65 00 78 00 65 00 63 00 20 00 73 00 70 00 5f 00 4d 00 53 00 66 00 6f 00 72 00 65 00 61 00 63 00 68 00 74 00 61 00 62 00 6c 00 65 00 } //00 00  exec sp_MSforeachtable
		$a_00_6 = {5d 04 00 00 38 30 03 80 5c 22 00 00 39 30 03 80 00 00 01 00 27 00 0c 00 c8 21 42 61 6e 6b 65 72 2e 42 41 4b 00 00 01 40 05 82 5f 00 04 00 87 10 00 00 66 94 29 d7 17 e8 d4 0b aa 22 b0 ef 18 79 06 00 5d 04 00 00 39 30 03 80 5c 20 00 00 3a 30 03 80 00 00 01 00 08 00 0a 00 ad 01 44 72 69 78 65 64 2e 41 00 00 01 40 05 } //82 70 
	condition:
		any of ($a_*)
 
}