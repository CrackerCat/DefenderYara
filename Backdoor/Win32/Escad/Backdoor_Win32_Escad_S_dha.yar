
rule Backdoor_Win32_Escad_S_dha{
	meta:
		description = "Backdoor:Win32/Escad.S!dha,SIGNATURE_TYPE_PEHSTR_EXT,03 00 03 00 05 00 00 01 00 "
		
	strings :
		$a_03_0 = {8a 04 17 8b fb 34 90 01 01 46 88 02 83 c9 ff 33 c0 42 f2 ae f7 d1 49 3b f1 72 e3 90 00 } //02 00 
		$a_80_1 = {25 73 64 2e 65 25 73 63 20 6e 25 73 73 68 25 73 72 65 77 61 25 73 20 61 64 25 73 20 70 6f 25 73 6f 70 25 73 69 6e 67 20 54 25 73 20 25 64 20 22 25 73 22 } //%sd.e%sc n%ssh%srewa%s ad%s po%sop%sing T%s %d "%s"  01 00 
		$a_80_2 = {25 73 6d 64 2e 65 78 25 73 63 20 22 25 73 20 3e 20 25 73 22 } //%smd.ex%sc "%s > %s"  01 00 
		$a_80_3 = {43 72 65 61 74 65 20 50 32 50 20 54 68 72 65 61 64 } //Create P2P Thread  01 00 
		$a_02_4 = {64 65 6c 20 22 90 02 10 69 66 20 65 78 69 73 74 20 22 90 00 } //00 00 
	condition:
		any of ($a_*)
 
}
rule Backdoor_Win32_Escad_S_dha_2{
	meta:
		description = "Backdoor:Win32/Escad.S!dha,SIGNATURE_TYPE_PEHSTR_EXT,01 00 01 00 03 00 00 01 00 "
		
	strings :
		$a_02_0 = {25 00 73 00 64 00 2e 00 65 00 25 00 73 00 63 00 20 00 22 00 25 00 73 00 20 00 3e 00 20 00 25 00 73 00 22 00 20 00 32 00 3e 00 26 00 31 00 90 02 10 63 00 6d 00 90 02 10 78 00 65 00 90 00 } //01 00 
		$a_00_1 = {25 00 73 00 64 00 2e 00 65 00 25 00 73 00 63 00 20 00 22 00 25 00 73 00 20 00 3e 00 20 00 25 00 73 00 22 00 20 00 32 00 3e 00 26 00 31 00 } //01 00 
		$a_00_2 = {25 00 73 00 6d 00 64 00 2e 00 65 00 78 00 25 00 73 00 63 00 20 00 22 00 25 00 73 00 20 00 3e 00 20 00 25 00 73 00 22 00 20 00 32 00 3e 00 26 00 31 00 } //00 00 
	condition:
		any of ($a_*)
 
}