
rule Trojan_Win32_Medfos_AF{
	meta:
		description = "Trojan:Win32/Medfos.AF,SIGNATURE_TYPE_PEHSTR_EXT,14 00 14 00 06 00 00 0a 00 "
		
	strings :
		$a_01_0 = {00 75 70 6c 6f 61 64 69 6e 67 2f 69 64 3d 25 64 26 75 3d } //0a 00 
		$a_00_1 = {00 00 5c 00 53 00 79 00 73 00 57 00 4f 00 57 00 36 00 34 00 5c 00 6d 00 73 00 69 00 65 00 78 00 65 00 63 00 2e 00 65 00 78 00 65 00 00 00 } //01 00 
		$a_03_2 = {05 00 00 ff 16 89 45 90 09 06 00 8b 75 90 01 01 81 c6 90 00 } //01 00 
		$a_03_3 = {05 00 00 ff 16 89 85 90 09 06 00 8b 75 90 01 01 81 c6 90 00 } //01 00 
		$a_03_4 = {05 00 00 ff 16 89 45 90 09 09 00 8b b5 90 01 04 81 c6 90 00 } //01 00 
		$a_03_5 = {05 00 00 ff 16 89 85 90 09 09 00 8b b5 90 01 04 81 c6 90 00 } //00 00 
	condition:
		any of ($a_*)
 
}
rule Trojan_Win32_Medfos_AF_2{
	meta:
		description = "Trojan:Win32/Medfos.AF,SIGNATURE_TYPE_PEHSTR_EXT,ffffffdd 00 ffffffdd 00 0b 00 00 64 00 "
		
	strings :
		$a_01_0 = {00 75 70 6c 6f 61 64 69 6e 67 2f 69 64 3d 25 64 26 75 3d } //64 00 
		$a_00_1 = {00 00 5c 00 53 00 79 00 73 00 57 00 4f 00 57 00 36 00 34 00 5c 00 6d 00 73 00 69 00 65 00 78 00 65 00 63 00 2e 00 65 00 78 00 65 00 00 00 } //0a 00 
		$a_01_2 = {3a 2f 2f 25 64 2e 25 64 2e 25 64 2e 25 64 2f } //0a 00 
		$a_01_3 = {00 75 70 6c 6f 61 64 69 6e 67 2f 69 64 3d 25 64 26 6d 3d 25 64 26 6e 3d 25 64 } //0a 00 
		$a_01_4 = {c7 45 fc 57 00 07 80 } //01 00 
		$a_01_5 = {81 c3 a4 05 00 00 } //01 00 
		$a_01_6 = {81 c1 a4 05 00 00 } //01 00 
		$a_01_7 = {81 c2 a4 05 00 00 } //01 00 
		$a_01_8 = {81 c0 a4 05 00 00 } //01 00 
		$a_01_9 = {81 c6 a4 05 00 00 } //01 00 
		$a_01_10 = {81 c7 a4 05 00 00 } //00 00 
		$a_00_11 = {7e 15 00 00 02 92 cc f9 9e b2 4b e5 71 51 6d 08 eb 1e 4d ed 00 00 00 00 62 7e 15 00 00 0e 6a 27 4d 6d 39 7d a9 e8 7c aa 2c da 1f 9d 36 00 00 00 00 62 7e 15 00 00 28 96 37 44 67 6a 0c d7 41 14 30 90 c5 35 cd 33 00 00 00 00 62 7e 15 00 00 35 a8 5f a9 d4 04 b3 16 f8 2b 15 20 13 91 e3 2d 00 00 00 00 62 7e 15 00 00 48 5e 6a a8 f8 78 eb 03 c0 47 da 47 54 0b 22 62 00 00 00 00 62 7e 15 00 00 4c 76 ba 80 ab 2b 25 53 e2 45 f0 3a 45 3e 0f ca 00 00 00 00 62 7e 15 00 00 56 4f 6c e3 bc e1 48 20 62 1d 40 84 64 05 98 be 00 00 00 00 62 7e 15 00 00 85 a1 3b 41 49 97 c7 c3 30 37 80 73 cc 75 f2 28 00 00 00 00 62 7e 15 00 00 89 8f aa d8 2d 16 } //81 e9 
	condition:
		any of ($a_*)
 
}