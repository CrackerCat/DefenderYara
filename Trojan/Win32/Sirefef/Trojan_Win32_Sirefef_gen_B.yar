
rule Trojan_Win32_Sirefef_gen_B{
	meta:
		description = "Trojan:Win32/Sirefef.gen!B,SIGNATURE_TYPE_PEHSTR_EXT,16 00 16 00 05 00 00 0a 00 "
		
	strings :
		$a_00_0 = {00 64 3a 5c 76 63 35 5c 72 65 6c 65 61 73 65 5c 65 77 73 2e } //0a 00 
		$a_00_1 = {4f 70 65 6e 53 43 4d 61 6e 61 67 65 72 57 } //02 00  OpenSCManagerW
		$a_02_2 = {47 45 54 20 2f 69 6e 73 74 61 6c 6c 20 48 54 54 50 2f 31 2e 31 90 02 05 48 6f 73 74 3a 20 25 73 90 02 05 69 64 3a 20 25 64 90 02 05 77 6d 69 64 3a 20 25 64 90 00 } //01 00 
		$a_00_3 = {2e 76 65 72 74 69 68 76 6f 73 74 66 65 65 64 2e 63 6f 6d 20 2f 69 64 } //01 00  .vertihvostfeed.com /id
		$a_00_4 = {30 00 44 00 30 00 38 00 36 00 41 00 35 00 44 00 2d 00 36 00 37 00 44 00 39 00 2d 00 34 00 37 00 30 00 66 00 2d 00 39 00 31 00 36 00 38 00 2d 00 30 00 39 00 36 00 38 00 46 00 46 00 33 00 33 00 42 00 46 00 44 00 39 00 } //00 00  0D086A5D-67D9-470f-9168-0968FF33BFD9
	condition:
		any of ($a_*)
 
}
rule Trojan_Win32_Sirefef_gen_B_2{
	meta:
		description = "Trojan:Win32/Sirefef.gen!B,SIGNATURE_TYPE_ARHSTR_EXT,16 00 16 00 05 00 00 0a 00 "
		
	strings :
		$a_00_0 = {00 64 3a 5c 76 63 35 5c 72 65 6c 65 61 73 65 5c 65 77 73 2e } //0a 00 
		$a_00_1 = {4f 70 65 6e 53 43 4d 61 6e 61 67 65 72 57 } //02 00  OpenSCManagerW
		$a_02_2 = {47 45 54 20 2f 69 6e 73 74 61 6c 6c 20 48 54 54 50 2f 31 2e 31 90 02 05 48 6f 73 74 3a 20 25 73 90 02 05 69 64 3a 20 25 64 90 02 05 77 6d 69 64 3a 20 25 64 90 00 } //01 00 
		$a_00_3 = {2e 76 65 72 74 69 68 76 6f 73 74 66 65 65 64 2e 63 6f 6d 20 2f 69 64 } //01 00  .vertihvostfeed.com /id
		$a_00_4 = {30 00 44 00 30 00 38 00 36 00 41 00 35 00 44 00 2d 00 36 00 37 00 44 00 39 00 2d 00 34 00 37 00 30 00 66 00 2d 00 39 00 31 00 36 00 38 00 2d 00 30 00 39 00 36 00 38 00 46 00 46 00 33 00 33 00 42 00 46 00 44 00 39 00 } //00 00  0D086A5D-67D9-470f-9168-0968FF33BFD9
	condition:
		any of ($a_*)
 
}