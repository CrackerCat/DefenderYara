
rule Trojan_Win32_Sality_R{
	meta:
		description = "Trojan:Win32/Sality.R,SIGNATURE_TYPE_PEHSTR_EXT,04 00 03 00 04 00 00 01 00 "
		
	strings :
		$a_02_0 = {6a 6f 68 de 00 00 00 6a 00 ff 15 90 01 02 40 00 a3 90 01 02 40 00 83 3d 90 01 02 40 00 00 0f 84 9d 02 00 00 8b 0d 90 01 02 40 00 51 6a 00 ff 15 90 01 02 40 00 a3 90 01 02 40 00 8b 15 90 01 02 40 00 52 6a 00 ff 15 90 01 02 40 00 90 00 } //01 00 
		$a_02_1 = {6a 6f 68 4d 01 00 00 6a 00 ff 15 90 01 02 40 00 a3 90 01 02 40 00 83 3d 90 01 02 40 00 00 0f 84 a3 02 00 00 8b 15 90 01 02 40 00 52 6a 00 ff 15 90 01 02 40 00 a3 90 01 02 40 00 a1 90 01 02 40 00 50 6a 00 ff 15 90 01 02 40 00 90 00 } //01 00 
		$a_00_2 = {5c 25 78 2e 65 78 65 } //01 00  \%x.exe
		$a_00_3 = {5c 25 64 2e 65 78 65 } //00 00  \%d.exe
	condition:
		any of ($a_*)
 
}