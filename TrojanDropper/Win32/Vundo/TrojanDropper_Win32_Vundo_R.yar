
rule TrojanDropper_Win32_Vundo_R{
	meta:
		description = "TrojanDropper:Win32/Vundo.R,SIGNATURE_TYPE_PEHSTR_EXT,01 00 01 00 4d 00 00 01 00 "
		
	strings :
		$a_41_0 = {e7 1f 8b de 83 c4 04 89 94 01 00 10 00 00 b9 20 00 00 00 01 } //00 1b 
		$a_81_1 = {d3 e6 00 00 81 c1 29 2e 00 00 33 ca 81 e6 ff 0f 00 00 89 94 06 00 10 00 00 01 00 1a 41 81 f1 23 e0 00 00 81 e2 ff 0f 00 00 2b ce 6a 20 83 e7 1f 89 b4 02 00 10 00 00 01 00 13 41 89 bc 01 00 10 00 } //00 8b 
		$a_83_2 = {1f 8b d6 bd 20 00 00 00 01 00 13 41 89 9c 01 00 10 00 00 8b fb 83 e7 1f 8b d6 bd 20 00 00 00 01 00 11 41 89 bc 01 00 10 00 00 8b d6 6a 20 8b df 83 e3 1f 59 01 00 14 41 83 e6 1f 8b da 83 c4 04 89 bc 01 00 10 00 00 b9 20 00 00 00 01 00 15 41 6a 20 81 e1 ff 0f 00 00 83 e3 1f 8b d6 89 bc 01 00 10 00 00 59 01 00 19 41 89 bc 01 00 10 00 00 8b ca c1 e9 18 c1 e2 08 0b ca 03 cf 81 f1 f4 97 00 00 01 00 11 41 89 bc 01 00 10 00 00 8b df 83 e3 1f b9 20 00 00 00 01 00 11 41 89 bc 01 00 10 00 00 8b df 83 e3 1f bd 20 00 00 00 01 00 0c 41 89 bc 01 00 10 00 00 6a 20 8b df 59 01 00 11 41 89 bc 01 00 10 00 00 6a 20 8b d6 8b df 83 e3 1f 59 01 00 22 41 89 bc 01 00 10 00 00 8b ca c1 } //e1 17 
		$a_ea_3 = {0b ca 2b cf 8b d1 c1 e9 07 c1 e2 19 0b d1 6a 20 8b df 59 01 00 17 41 89 bc 01 00 10 00 00 8b ca c1 e2 0d c1 e9 13 0b ca 81 c1 c1 49 00 00 01 00 17 41 89 bc 01 00 10 00 00 8b f7 83 e6 1f 81 f2 8f fd 00 00 b9 20 00 00 00 01 00 17 41 81 f6 1a a8 00 00 83 e3 1f 8b d6 89 bc 01 00 10 00 00 b9 20 00 00 00 01 00 16 41 81 f1 cd e9 00 00 89 94 06 00 10 00 00 03 ca 89 48 08 89 50 0c 5e 01 00 1a 41 81 f1 45 e9 00 00 89 94 06 00 10 00 00 81 e9 4f c9 00 00 89 48 08 89 50 0c 5e 01 00 20 41 89 94 06 00 10 00 00 8b f1 c1 ee 16 c1 e1 0a 0b f1 89 50 0c 81 ee 39 ae 00 00 81 f6 d9 77 00 00 01 } //00 13 
		$a_89_4 = {06 00 10 00 00 81 f1 32 cf 00 00 81 c1 ee eb 00 00 01 00 17 41 89 94 06 00 10 00 00 8b f1 c1 e6 16 c1 e9 0a 0b f1 81 ee cb f3 00 00 01 00 17 41 81 f1 b5 c5 00 00 2b ca 81 e6 ff 0f 00 00 33 ca 89 } //94 06 
		$a_00_6 = {1d } //41 89 
		$a_06_7 = {00 10 00 00 33 ca 8b f1 c1 ee 14 c1 e1 0c 0b f1 83 c4 04 89 70 08 89 50 0c 5e 01 00 19 41 81 f1 41 ff 00 00 81 e6 ff 0f 00 00 81 e9 48 ff 00 00 89 94 06 00 10 00 00 01 00 25 41 81 f1 d6 a1 00 00 81 e9 e8 b6 00 00 81 e2 ff 0f 00 00 8b de 8b f9 83 e3 1f b9 20 00 00 00 89 b4 02 00 10 00 00 01 00 13 41 89 b4 02 00 10 00 00 81 f1 17 c7 00 00 81 c1 a0 5b 00 00 01 00 12 41 81 c1 eb 88 00 00 6a 20 83 e7 1f 89 b4 02 00 10 00 00 01 00 16 41 89 b4 02 } //00 10 
		$a_e9_9 = {c1 e2 1a 0b d1 6a 20 8b fe 59 01 00 1b 41 81 c1 bf b0 00 00 81 f1 e8 a5 00 00 2b ce 81 e2 ff 0f 00 00 89 b4 02 00 10 00 00 01 00 17 41 89 b4 02 00 10 00 00 8b d1 c1 e9 0a c1 e2 16 0b d1 81 f2 b2 fb 00 00 01 00 1b 41 89 b4 02 00 10 00 00 33 ce 03 ce 8b d1 c1 ea 19 c1 e1 07 0b d1 81 ea 3a 40 00 00 01 00 13 41 81 f1 6c ed 00 00 81 e2 ff 0f 00 00 89 b4 02 00 10 00 00 01 00 12 41 89 b4 02 00 10 00 00 8b d1 c1 ea 11 c1 e1 0f 0b d1 59 01 00 13 41 81 f1 d9 a2 00 00 81 e2 ff 0f 00 00 89 b4 02 00 10 00 00 01 00 15 41 81 f1 68 98 00 00 03 ce 81 e2 ff 0f 00 00 89 b4 02 00 10 00 00 01 } //00 15 
		$a_89_10 = {02 00 10 00 00 c1 ee 18 c1 e1 08 0b f1 81 ee f7 d9 00 00 01 00 13 41 81 f2 5e 23 00 00 2b d7 8b f2 d3 ee 8b cb d3 e2 8b 4d 08 01 00 15 41 81 f2 d3 41 00 00 81 ea 02 41 00 00 8b f2 d3 e6 8b cf d3 } //ea 5f 
		$a_00_11 = {15 } //41 89 
		$a_02_12 = {00 10 00 00 81 f1 5a 79 00 00 8b d1 c1 ea 14 c1 e1 0c 01 00 12 41 81 f6 32 07 00 00 81 c6 4c 3a 00 00 81 f6 1b 79 00 00 01 00 10 41 81 e9 4f b6 00 00 33 ce 2b ce 81 f1 d1 b0 00 00 01 00 0d 41 81 f1 e9 61 00 00 81 c1 3d 51 00 00 5e 01 00 0d 41 89 b4 01 00 10 00 00 81 f2 64 83 00 00 01 00 1b 41 89 b4 01 00 10 00 00 33 d6 8b ca c1 e9 11 c1 e2 0f 0b ca 33 ce 81 e9 f1 c5 00 00 01 00 16 41 81 ee 33 ef 00 00 8b ce c1 e1 1a c1 ee 06 0b ce 81 e9 e7 36 00 00 01 00 15 41 89 b4 01 00 10 00 00 8b ca c1 e2 0e c1 e9 12 0b ca 03 ce 8b d1 01 00 17 41 89 b4 01 00 10 00 00 8b } //ca c1 
		$a_03_13 = {c1 e1 1d 0b ca 81 f1 b1 7c 00 00 01 00 17 41 89 bc 01 00 10 00 00 8b ca c1 e2 0f c1 e9 11 0b ca 81 e9 fb c0 00 00 01 00 14 41 81 c2 76 f9 00 00 81 f2 0d 8d 00 00 8b f2 c1 ee 0f c1 e2 11 01 00 10 41 81 f2 31 c7 00 00 2b cf 8b da d3 eb 8b cf d3 e2 01 00 0d 41 81 ea a2 d2 00 00 33 d7 8b df 83 e3 1f 01 00 14 41 81 c6 20 fa 00 00 83 e3 1f b9 20 00 00 00 2b cb 8b d6 d3 e2 01 00 14 41 6a 20 81 e1 ff 0f 00 00 83 e3 1f 8b d7 89 b4 01 00 10 00 00 01 00 12 41 81 e2 ff 0f 00 00 89 bc 02 00 10 00 00 8b d1 c1 ea 1a 01 00 15 41 81 e1 ff 0f 00 00 89 b4 01 00 10 00 00 8b ca c1 e9 14 c1 e2 0c 01 00 0f 41 89 b4 01 00 10 00 00 6a 20 8b fe 59 83 e7 1f 01 00 15 41 81 f1 5a 08 00 00 81 e6 ff 0f 00 00 03 ca 89 94 06 } //00 10 
		$a_41_15 = {bc 02 00 10 00 00 8b d1 c1 ea 1d c1 e1 03 0b d1 81 c2 13 b7 00 00 01 } //00 17 
		$a_89_16 = {01 00 10 00 00 8b ce c1 e6 02 c1 e9 1e 0b ce 81 e9 46 4e 00 00 01 00 1e 41 89 b4 01 00 10 00 00 8b fe 83 e7 1f b9 20 00 00 00 2b cf 8b da d3 eb 8b cf d3 e2 83 c4 04 01 00 1f 41 89 b4 01 00 10 00 } //00 59 
		$a_cf_17 = {70 0c d3 eb 8b cf 5f d3 e2 0b da 03 de 5e 81 f3 8b 76 00 00 01 00 14 41 81 ea d3 67 00 00 8b f2 d3 e6 8b cb d3 ea 5f 0b f2 89 70 } //08 01 
		$a_00_19 = {10 } //00 00 
		$a_ca_20 = {ea 08 c1 e1 18 0b ca 81 f1 3e 42 00 00 01 00 14 41 81 c6 91 53 00 00 8b fe d3 e7 8b cb d3 ee 8b c8 8b 44 24 10 01 00 14 41 81 c6 af 81 00 00 8b d6 c1 e6 0e c1 ea 12 0b d6 03 d7 8b f2 01 00 15 41 81 f1 fc 95 00 00 8b d1 c1 e2 12 c1 e9 0e 0b d1 03 d6 89 70 0c 01 00 16 41 81 e9 9c f4 00 00 8b d1 c1 e9 09 c1 e2 17 0b d1 81 ea 3c ac 00 00 01 00 18 41 89 bc 02 00 10 00 00 8b d1 c1 ea 1c c1 e1 04 0b d1 59 81 f2 29 1c 00 } //00 01 
		$a_00_22 = {10 } //00 00 
		$a_ca_23 = {e2 09 c1 e9 17 0b ca 2b ce 33 ce 8b d1 c1 e2 16 c1 e9 0a 0b d1 03 d6 83 c4 04 89 70 0c 89 50 08 01 00 2a 41 89 b4 01 00 10 00 00 8b fe 33 d6 83 e7 1f b9 20 00 00 00 2b cf 8b da d3 eb 8b cf 83 c4 04 d3 e2 5f 89 70 0c 5e 0b da 89 58 08 01 00 3a 41 89 b4 01 00 10 00 00 b9 20 00 00 00 2b cb 89 70 0c d3 e2 8b cb d3 ef 0b d7 5f 03 d6 8b ca c1 e1 1d c1 ea 03 0b ca 03 ce 33 ce 8b d1 c1 ea 17 c1 e1 09 0b d1 2b d6 5e 89 50 } //08 01 
		$a_00_25 = {10 00 } //00 81 
		$a_14_26 = {00 00 2b cf 8b d1 c1 ea 1f 03 c9 0b d1 03 d7 8b df 83 e3 1f 8b f2 b9 20 00 00 00 2b cb d3 ee 8b cb d3 e2 83 c4 04 89 78 0c 01 00 31 41 89 bc 02 00 10 00 00 8b d1 c1 e2 13 c1 e9 0d 0b d1 03 d7 8b df 83 e3 1f 8b f2 bd 20 00 00 00 2b eb 8b cd d3 ee 8b cb d3 e2 8b cd 83 c4 04 89 78 0c 01 00 1f 41 89 94 06 00 10 00 00 8b f1 c1 e6 1e c1 e9 02 0b f1 33 f2 81 ee 39 ab 00 00 81 f6 53 98 00 00 01 00 1a 41 81 c6 7e 47 00 00 8b fe d3 e7 8b 4d 10 d3 ee 8b 4d 0c 0b fe 81 ef a1 66 00 00 01 00 14 41 89 bc 02 00 10 00 00 c1 ee 13 0b f1 8b df 81 c6 24 81 00 00 00 00 80 10 00 00 e3 3e 01 52 b6 8a 78 e8 07 d9 38 0c 00 10 00 80 80 10 00 00 b2 65 bd d7 ec 1a 46 a5 69 4d b2 b3 00 10 00 80 80 10 00 00 e0 a7 e4 ee 90 be 65 ac 3e f4 e7 54 } //00 10 
	condition:
		any of ($a_*)
 
}