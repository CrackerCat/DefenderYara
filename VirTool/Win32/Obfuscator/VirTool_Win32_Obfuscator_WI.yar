
rule VirTool_Win32_Obfuscator_WI{
	meta:
		description = "VirTool:Win32/Obfuscator.WI,SIGNATURE_TYPE_PEHSTR_EXT,03 00 02 00 02 00 00 01 00 "
		
	strings :
		$a_01_0 = {8b 45 fc c6 40 01 65 8b 4d fc 51 ff 15 } //01 00 
		$a_01_1 = {8b 55 08 03 55 f4 8b 02 03 45 f4 8b 4d 08 03 4d f4 89 01 c7 45 fc 7c 00 00 00 8b 55 f4 81 c2 53 57 09 00 89 55 f8 c7 45 fc 7c 00 00 00 8b 45 08 03 45 f4 8b 08 33 4d f8 8b 55 08 03 55 f4 89 0a eb } //00 00 
	condition:
		any of ($a_*)
 
}
rule VirTool_Win32_Obfuscator_WI_2{
	meta:
		description = "VirTool:Win32/Obfuscator.WI,SIGNATURE_TYPE_PEHSTR_EXT,05 00 02 00 02 00 00 01 00 "
		
	strings :
		$a_11_0 = {8e 88 00 00 00 89 f0 05 8e 00 00 00 8b 18 53 66 8b 5c 24 02 83 c0 04 66 8b 10 66 89 1c 24 66 89 54 24 02 5e ad 81 78 10 60 00 00 40 01 } //00 25 
		$a_e8_1 = {00 00 00 8b 44 24 08 50 8b 44 24 08 50 8b 44 24 08 50 31 } //c0 68 
		$a_ca_2 = {de e9 90 01 01 00 00 00 c3 90 00 00 00 5d 04 00 00 81 9b 02 80 5c 1c 00 00 83 9b 02 80 00 00 01 00 25 00 06 00 8f 01 56 42 2e 5a 00 00 01 40 05 82 5d 00 04 00 87 10 00 00 ed 8f 85 fe e6 4f 0a 89 50 15 ec 3d 70 4f 32 00 5d 04 00 00 83 9b 02 80 5c 21 00 00 85 9b 02 80 00 00 01 00 06 00 0b 00 84 21 50 69 6e 67 62 65 64 2e 42 00 00 01 40 05 82 42 00 04 00 78 63 00 00 02 00 02 00 02 00 00 01 00 26 00 4b 69 6c 6c 69 6e 67 20 70 72 6f 63 65 73 73 20 25 64 20 00 4b 69 6c 6c 69 6e 67 20 70 72 6f 63 65 73 73 20 25 73 01 00 2c 03 3c 0a 75 0a 80 7d 90 01 01 0d 74 04 c6 01 0d 41 88 01 88 45 90 1b 00 8b 45 90 01 01 41 40 89 45 90 1b 02 3b 45 90 01 01 72 dc 90 00 00 00 5d 04 00 00 85 9b 02 80 5c 20 00 00 87 9b 02 80 00 00 01 00 25 00 0a 00 8c 21 44 6f 6f 78 75 64 2e } //41 00 
	condition:
		any of ($a_*)
 
}