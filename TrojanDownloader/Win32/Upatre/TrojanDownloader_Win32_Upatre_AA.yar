
rule TrojanDownloader_Win32_Upatre_AA{
	meta:
		description = "TrojanDownloader:Win32/Upatre.AA,SIGNATURE_TYPE_PEHSTR_EXT,0b 00 09 00 17 00 00 0a 00 "
		
	strings :
		$a_03_0 = {89 7c 24 2c 80 90 01 01 4d 75 90 01 01 80 90 01 01 01 5a 0f 84 90 01 04 8b 44 24 10 8b 14 90 01 05 33 c0 8b cf 40 c1 e9 02 3b c8 76 90 01 01 31 90 01 02 40 90 00 } //0a 00 
		$a_01_1 = {03 f7 8b 06 33 c2 89 06 42 49 75 } //0a 00 
		$a_01_2 = {03 f2 8b 06 33 c7 89 06 47 49 75 } //08 00 
		$a_01_3 = {8a cc 8b 45 e8 8b 14 88 6a 04 5f 8b 4d 04 c1 e9 02 49 8b 75 00 03 f7 31 16 42 e2 f9 } //0a 00 
		$a_03_4 = {8b 00 66 3d 4d 5a 0f 84 90 01 04 8b 45 b4 c1 e0 02 89 45 a8 90 00 } //0a 00 
		$a_03_5 = {8b 07 66 3d 4d 5a 74 90 01 01 8b 45 88 8b c8 8b 95 90 01 04 c1 e0 02 03 d0 8b 02 90 00 } //0a 00 
		$a_01_6 = {80 3b 4d 8b f8 75 12 80 7b 01 5a 75 0c ff 75 fc 53 57 e8 } //0a 00 
		$a_03_7 = {89 74 24 20 80 90 01 01 5a 0f 85 90 01 04 80 90 01 01 01 5a 0f 85 90 01 04 80 90 01 01 02 50 0f 85 90 01 04 80 90 01 01 03 00 0f 85 90 01 04 8b 54 24 28 33 c0 8b 14 90 01 05 8b ce c1 e9 02 40 3b c8 76 08 31 90 01 02 40 90 00 } //0a 00 
		$a_01_8 = {8b 55 e4 0f b7 42 3c 03 d0 0f b7 4a 06 83 c2 14 0f b7 02 } //0a 00 
		$a_01_9 = {89 45 04 89 45 44 8b 45 00 66 81 38 4d 5a } //08 00 
		$a_01_10 = {89 45 c0 89 45 e0 8b 45 bc 8b 00 66 3d 4d 5a } //03 00 
		$a_01_11 = {00 00 33 c0 39 44 24 0c 76 15 8b 4c 24 08 8a 0c 08 8b 54 24 04 88 0c 10 40 3b 44 24 0c 72 eb } //01 00 
		$a_80_12 = {00 61 70 70 6c 69 63 61 74 69 6f 6e 2f 2a 00 } //  01 00 
		$a_80_13 = {00 74 65 78 74 2f 2a 00 } //  01 00 
		$a_80_14 = {2e 72 61 72 00 } //.rar  01 00 
		$a_80_15 = {2e 65 6e 63 00 } //.enc  01 00 
		$a_80_16 = {2e 64 61 74 00 } //.dat  01 00 
		$a_80_17 = {2e 7a 69 70 00 } //.zip  01 00 
		$a_80_18 = {2e 63 6c 6c 00 } //.cll  01 00 
		$a_80_19 = {2e 70 64 66 00 } //.pdf  02 00 
		$a_12_20 = {3a 5c 54 45 4d 50 5c 90 02 06 2e 65 78 65 90 00 01 } //00 28 
		$a_00_23 = {74 00 65 00 73 00 20 00 64 00 6f 00 77 00 6e 00 6c 00 6f 00 61 00 64 00 65 00 72 00 00 00 01 00 1c 00 43 00 6f 00 6e 00 63 00 68 00 69 00 74 00 61 00 20 00 57 00 75 00 72 00 73 00 74 00 00 00 80 10 00 00 92 ab 4b 2d 0e 20 bc 09 0c 10 08 7f 00 04 00 80 80 10 00 00 92 ab 4b 2d 28 6c 03 7e 96 } //69 5f 
	condition:
		any of ($a_*)
 
}