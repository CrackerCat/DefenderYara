
rule TrojanDownloader_O97M_Donoff_gen_H{
	meta:
		description = "TrojanDownloader:O97M/Donoff.gen!H,SIGNATURE_TYPE_MACROHSTR_EXT,03 00 03 00 06 00 00 01 00 "
		
	strings :
		$a_02_0 = {28 22 6b 77 77 73 3d 32 32 90 02 40 22 29 2c 20 45 6e 76 69 72 6f 6e 28 22 74 90 02 05 65 6d 70 22 29 20 26 90 00 } //01 00 
		$a_00_1 = {31 68 7b 68 22 29 2c 20 22 22 2c 20 76 62 4e 75 6c 6c 53 74 72 69 6e 67 2c 20 76 62 4e 6f 72 6d 61 6c 46 6f 63 75 73 } //01 00  1h{h"), "", vbNullString, vbNormalFocus
		$a_00_2 = {31 68 7b 68 22 29 2c 20 30 2c 20 30 0d 0a } //01 00 
		$a_00_3 = {20 30 2c 20 22 6f 70 65 6e 22 2c 20 45 6e 76 69 72 6f 6e 24 28 22 74 6d 70 22 29 20 26 } //02 00   0, "open", Environ$("tmp") &
		$a_02_4 = {28 22 6b 77 77 73 3d 32 32 90 02 40 31 68 7b 68 22 29 2c 20 45 6e 76 69 72 6f 6e 28 22 90 00 } //01 00 
		$a_02_5 = {30 2c 20 22 6f 70 65 6e 22 2c 20 45 6e 76 69 72 6f 6e 24 28 90 02 20 29 20 26 20 90 02 20 28 22 90 02 10 31 68 7b 68 22 29 2c 20 22 22 2c 20 76 62 4e 75 6c 6c 53 74 72 69 6e 67 90 00 } //00 00 
		$a_00_6 = {5d 04 } //00 00  —ù
	condition:
		any of ($a_*)
 
}