
rule TrojanDownloader_O97M_Obfuse_JF_MTB{
	meta:
		description = "TrojanDownloader:O97M/Obfuse.JF!MTB,SIGNATURE_TYPE_MACROHSTR_EXT,04 00 04 00 04 00 00 01 00 "
		
	strings :
		$a_01_0 = {28 45 6e 76 69 72 6f 6e 28 22 54 45 4d 50 22 29 29 } //01 00 
		$a_03_1 = {43 61 6c 6c 20 90 02 09 28 90 02 09 2e 90 02 09 2c 20 22 76 65 72 69 6e 73 74 65 72 65 2e 78 6c 73 22 2c 20 30 29 90 00 } //01 00 
		$a_01_2 = {3d 20 56 42 41 2e 53 70 6c 69 74 28 22 22 29 } //01 00 
		$a_01_3 = {3d 20 56 42 41 2e 4d 69 64 24 28 } //00 00 
	condition:
		any of ($a_*)
 
}
rule TrojanDownloader_O97M_Obfuse_JF_MTB_2{
	meta:
		description = "TrojanDownloader:O97M/Obfuse.JF!MTB,SIGNATURE_TYPE_MACROHSTR_EXT,06 00 06 00 05 00 00 02 00 "
		
	strings :
		$a_03_0 = {36 38 37 34 37 34 37 30 37 33 22 29 20 26 20 90 02 0f 28 22 33 61 32 66 32 66 36 62 37 32 36 35 36 35 32 65 36 64 36 39 36 33 37 32 36 66 37 34 36 31 36 62 36 34 36 39 37 32 36 35 36 33 37 34 32 65 36 33 36 66 36 64 32 66 36 37 37 32 36 35 37 39 36 64 36 66 36 39 37 32 32 66 90 02 32 32 65 90 00 } //01 00 
		$a_03_1 = {43 68 72 24 28 56 61 6c 28 22 26 48 22 20 26 20 4d 69 64 24 28 90 02 0f 2c 20 90 02 0f 2c 20 32 29 29 29 90 00 } //01 00 
		$a_03_2 = {47 65 74 4f 62 6a 65 63 74 28 90 02 0f 28 22 37 37 36 39 36 65 36 64 36 37 36 64 37 34 37 33 33 61 35 63 22 29 20 26 20 90 02 0f 28 22 35 63 32 65 35 63 37 32 36 66 36 66 37 34 35 63 36 33 36 39 36 64 37 36 33 32 22 29 29 90 00 } //01 00 
		$a_03_3 = {36 37 37 32 36 35 37 39 36 64 22 29 20 26 20 90 02 0f 28 22 36 66 37 32 36 35 32 65 36 35 37 38 36 35 90 00 } //01 00 
		$a_03_4 = {47 65 74 4f 62 6a 65 63 74 28 90 02 0f 28 22 37 37 36 39 36 65 36 64 36 37 36 64 37 34 37 33 33 61 35 63 35 63 32 65 35 63 37 32 36 66 36 66 37 34 35 63 36 33 36 39 36 64 37 36 33 32 33 61 35 37 22 29 20 26 20 90 02 0f 28 22 36 39 36 65 33 33 33 32 35 66 35 30 37 32 36 66 36 33 36 35 37 33 37 33 22 29 29 90 00 } //00 00 
	condition:
		any of ($a_*)
 
}
rule TrojanDownloader_O97M_Obfuse_JF_MTB_3{
	meta:
		description = "TrojanDownloader:O97M/Obfuse.JF!MTB,SIGNATURE_TYPE_MACROHSTR_EXT,04 00 04 00 04 00 00 01 00 "
		
	strings :
		$a_00_0 = {55 52 4c 44 65 63 6f 64 65 28 22 25 37 30 25 36 66 25 37 37 25 36 35 25 37 32 25 37 33 25 36 38 25 36 35 25 36 63 25 36 63 25 32 30 25 32 64 25 37 33 25 37 34 25 36 31 25 32 30 25 32 64 25 36 65 25 36 66 25 37 30 25 32 30 25 32 64 25 37 37 25 32 30 25 36 38 25 36 39 25 36 34 25 36 34 25 36 35 25 36 65 25 32 30 25 32 64 25 36 35 25 37 38 25 36 35 25 36 33 25 32 30 25 36 32 25 37 39 25 37 30 25 36 31 25 37 33 25 37 33 25 32 30 25 32 65 25 32 30 22 29 } //01 00 
		$a_00_1 = {25 36 38 25 37 34 25 37 34 25 37 30 25 37 33 25 33 61 25 32 66 25 32 66 25 36 33 25 36 34 25 36 65 25 32 65 25 36 31 25 36 63 25 37 35 25 36 64 25 36 65 25 36 39 25 36 65 25 36 35 25 37 34 25 37 37 25 36 66 25 37 32 25 36 62 25 32 65 25 37 33 25 36 39 25 37 34 25 36 35 25 32 66 25 33 37 25 33 33 25 33 35 25 36 36 25 33 34 25 36 34 25 33 37 25 33 35 25 36 35 25 36 33 25 36 35 25 36 31 25 36 36 25 36 36 25 33 30 25 33 34 25 36 31 25 33 39 25 36 31 25 36 36 25 33 30 25 33 31 25 36 32 25 36 36 25 36 36 25 33 31 25 33 37 25 33 38 25 33 35 25 33 36 25 33 39 25 33 34 25 32 66 25 37 33 25 37 35 25 37 32 25 37 36 25 36 35 25 37 39 25 32 65 25 36 37 25 36 31 25 37 34 25 36 38 25 36 35 25 37 32 } //01 00 
		$a_00_2 = {25 34 33 25 33 61 25 35 63 25 37 37 25 36 39 25 36 65 25 36 34 25 36 66 25 37 37 25 37 33 25 35 63 25 37 34 25 36 35 25 36 64 25 37 30 25 35 63 25 37 33 25 37 35 25 37 32 25 37 36 25 36 35 25 37 39 25 32 65 25 37 30 25 37 33 25 33 31 } //01 00 
		$a_03_3 = {4d 69 64 28 53 74 72 69 6e 67 54 6f 44 65 63 6f 64 65 2c 20 90 02 0a 20 2b 20 31 2c 20 32 29 90 00 } //00 00 
	condition:
		any of ($a_*)
 
}