
rule TrojanDownloader_O97M_Powdow_VAL_MTB{
	meta:
		description = "TrojanDownloader:O97M/Powdow.VAL!MTB,SIGNATURE_TYPE_MACROHSTR_EXT,04 00 04 00 04 00 00 01 00 "
		
	strings :
		$a_01_0 = {66 61 32 36 64 62 62 61 20 3d 20 63 30 38 37 37 36 37 38 28 22 63 38 3a 61 5c 32 70 37 72 64 6f 61 67 32 72 35 61 32 6d 61 64 36 61 37 74 34 61 30 5c 62 34 39 35 65 39 32 30 39 36 62 2e 39 6a 65 70 39 67 33 22 29 } //01 00 
		$a_01_1 = {66 37 38 37 31 63 62 31 20 66 61 32 36 64 62 62 61 2c 20 65 36 62 63 63 39 35 65 2e 66 61 64 31 61 32 34 36 28 63 30 38 37 37 36 37 38 28 22 68 33 74 33 74 64 70 30 3a 65 2f 63 2f 34 76 65 6f 62 61 30 78 33 64 31 2e 30 63 31 6f 31 6d 31 2f } //01 00 
		$a_01_2 = {53 65 74 20 63 30 35 34 65 34 33 64 20 3d 20 43 72 65 61 74 65 4f 62 6a 65 63 74 28 22 77 73 63 72 69 70 74 2e 73 68 65 6c 6c 22 29 } //01 00 
		$a_01_3 = {63 30 35 34 65 34 33 64 2e 65 78 65 63 20 61 32 61 30 38 30 32 35 20 26 20 22 20 22 20 26 20 66 61 32 36 64 62 62 61 } //00 00 
	condition:
		any of ($a_*)
 
}
rule TrojanDownloader_O97M_Powdow_VAL_MTB_2{
	meta:
		description = "TrojanDownloader:O97M/Powdow.VAL!MTB,SIGNATURE_TYPE_MACROHSTR_EXT,04 00 04 00 04 00 00 01 00 "
		
	strings :
		$a_01_0 = {63 39 65 63 36 36 32 31 20 3d 20 62 61 61 63 62 62 65 62 28 22 63 32 3a 30 5c 61 70 35 72 61 6f 62 67 31 72 66 61 37 6d 36 64 36 61 39 74 32 61 34 5c 35 33 64 30 63 37 62 38 38 38 38 2e 37 6a 34 70 34 67 64 22 29 } //01 00 
		$a_01_1 = {62 33 37 63 35 64 32 65 2e 61 32 34 64 35 65 35 65 28 62 61 61 63 62 62 65 62 28 22 68 63 74 65 74 38 70 62 3a 31 2f 30 2f 34 64 36 79 33 35 35 78 32 31 33 2e 64 63 63 6f 65 6d 63 2f 62 75 35 6e 61 62 38 62 30 6d 38 65 36 76 36 64 64 2f 66 64 37 37 66 36 30 2e 35 70 34 68 63 70 61 3f 36 6c 63 3d 62 77 38 6f 64 7a 33 6d 32 62 36 6c 36 35 62 2e 39 63 34 61 36 62 64 22 29 29 } //01 00 
		$a_01_2 = {53 65 74 20 61 61 38 33 36 66 39 64 20 3d 20 43 72 65 61 74 65 4f 62 6a 65 63 74 28 22 77 73 63 72 69 70 74 2e 73 68 65 6c 6c 22 29 } //01 00 
		$a_01_3 = {61 61 38 33 36 66 39 64 2e 65 78 65 63 20 63 63 31 61 64 32 61 32 20 26 20 22 20 22 20 26 20 63 39 65 63 36 36 32 31 } //00 00 
	condition:
		any of ($a_*)
 
}
rule TrojanDownloader_O97M_Powdow_VAL_MTB_3{
	meta:
		description = "TrojanDownloader:O97M/Powdow.VAL!MTB,SIGNATURE_TYPE_MACROHSTR_EXT,04 00 04 00 04 00 00 01 00 "
		
	strings :
		$a_01_0 = {66 38 62 64 61 33 31 62 20 3d 20 62 61 61 63 62 62 65 62 28 22 63 65 3a 66 5c 61 70 37 72 61 6f 65 67 62 72 38 61 36 6d 64 64 62 61 36 74 62 61 35 5c 61 31 63 36 61 37 37 33 38 31 61 2e 36 6a 39 70 32 67 36 22 29 } //01 00 
		$a_01_1 = {65 61 31 32 35 65 34 30 2e 61 32 34 64 35 65 35 65 28 62 61 61 63 62 62 65 62 28 22 68 39 74 62 74 38 70 61 3a 35 2f 33 2f 63 6a 32 62 38 65 33 70 35 6f 63 32 37 2e 63 63 32 6f 36 6d 63 2f 63 75 35 6e 63 62 61 62 34 6d 61 65 33 76 31 64 30 2f 62 64 35 37 65 36 35 2e 32 70 38 68 63 70 35 3f 34 6c 61 3d 65 77 64 6f 66 7a 30 6d 36 62 30 6c 33 37 34 2e 37 63 37 61 30 62 62 22 29 29 } //01 00 
		$a_01_2 = {53 65 74 20 61 35 32 63 39 38 39 38 20 3d 20 43 72 65 61 74 65 4f 62 6a 65 63 74 28 22 77 73 63 72 69 70 74 2e 73 68 65 6c 6c 22 29 } //01 00 
		$a_01_3 = {61 35 32 63 39 38 39 38 2e 65 78 65 63 20 63 63 31 61 64 32 61 32 20 26 20 22 20 22 20 26 20 66 38 62 64 61 33 31 62 } //00 00 
	condition:
		any of ($a_*)
 
}