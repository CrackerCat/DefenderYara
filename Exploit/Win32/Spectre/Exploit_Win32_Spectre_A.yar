
rule Exploit_Win32_Spectre_A{
	meta:
		description = "Exploit:Win32/Spectre.A,SIGNATURE_TYPE_PEHSTR_EXT,56 04 56 04 13 00 00 57 04 "
		
	strings :
		$a_00_0 = {6d 61 6c 69 63 69 6f 75 73 5f 78 20 3d 20 25 70 } //01 00 
		$a_00_1 = {53 71 75 65 61 6d 69 73 68 20 4f 73 73 69 66 72 61 67 65 } //57 04 
		$a_00_2 = {49 6e 2d 53 70 65 63 74 72 65 5f 6d 65 6c 74 64 6f 77 6e 00 } //57 04 
		$a_00_3 = {6d 65 6c 74 64 6f 77 6e 2d 70 6f 63 2e 70 64 62 } //0a 00 
		$a_00_4 = {5c 4d 65 6c 74 64 6f 77 6e 2e 70 64 62 00 } //57 04 
		$a_00_5 = {5c 4d 65 6c 74 64 6f 77 6e 2d 50 6f 43 2d 57 69 } //57 04 
		$a_00_6 = {5c 6d 5c 6d 32 5c 78 36 34 5c 44 65 62 75 67 5c 68 65 6c 6c 6f 2e 70 64 62 00 } //e8 03 
		$a_00_7 = {30 78 25 30 32 78 3a 20 67 75 65 73 73 3a 20 30 78 25 30 32 78 2c 20 72 65 61 6c 3a 30 78 25 30 32 78 } //64 00 
		$a_03_8 = {ab aa aa 2a 90 02 02 f7 90 01 03 c1 90 01 01 1f 90 00 } //e8 03 
		$a_03_9 = {48 33 c0 0f 90 02 20 0f ae 3f 49 81 fa 19 04 00 00 90 00 } //64 00 
		$a_03_10 = {0f 01 f9 4c 90 02 2d 0f 01 f9 90 00 } //64 00 
		$a_03_11 = {0f 01 f9 8b 90 02 2d 0f 01 f9 90 00 } //64 00 
		$a_03_12 = {0f 01 f9 89 90 02 2d 0f 01 f9 90 00 } //64 00 
		$a_03_13 = {0f ae f0 0f 31 90 02 2d 0f ae f0 0f 31 90 00 } //0a 00 
		$a_03_14 = {0f ae 38 83 45 90 01 01 01 90 00 } //0a 00 
		$a_01_15 = {48 0f ae 39 48 8d } //0a 00 
		$a_01_16 = {0f ae 38 05 00 } //0a 00 
		$a_01_17 = {66 66 66 0f 1f 84 00 00 00 00 00 } //0a 00 
		$a_03_18 = {81 7d e8 ff 00 00 00 7e 90 01 01 8b 45 90 01 01 8b 14 85 90 01 02 40 00 8b 45 90 01 01 8b 04 85 90 01 02 40 00 01 c0 83 c0 05 39 c2 7d 90 00 } //00 00 
	condition:
		any of ($a_*)
 
}