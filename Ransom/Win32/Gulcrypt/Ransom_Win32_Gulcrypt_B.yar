
rule Ransom_Win32_Gulcrypt_B{
	meta:
		description = "Ransom:Win32/Gulcrypt.B,SIGNATURE_TYPE_PEHSTR_EXT,03 00 03 00 08 00 00 01 00 "
		
	strings :
		$a_01_0 = {40 46 69 6c 65 73 5f 79 6f 75 72 5f 69 44 } //01 00 
		$a_01_1 = {2f 61 73 6d 2f 74 65 73 74 2e 70 68 70 00 68 65 6c 6c 6f 3d } //01 00 
		$a_01_2 = {62 75 6b 61 73 68 6b 61 } //01 00 
		$a_01_3 = {70 6c 6f 67 61 65 72 6f } //01 00 
		$a_01_4 = {21 c2 ee f1 f1 f2 e0 ed ee e2 e8 f2 fc 20 } //01 00 
		$a_01_5 = {2f 74 61 73 6b 2f 72 65 73 2e 70 68 70 00 68 65 6c 6c 6f 3d } //02 00 
		$a_01_6 = {b9 19 00 00 00 bb 01 00 00 00 d3 e3 23 d8 74 2d 80 c1 41 88 0d 00 30 40 00 80 e9 41 c7 05 01 30 40 00 3a 5c 2a 2e c6 05 05 30 40 00 2a c6 05 06 30 40 00 00 50 51 e8 7b f7 ff ff } //01 00 
		$a_01_7 = {c7 80 00 30 40 00 5c 2a 2e 2a c6 80 04 30 40 00 00 e8 54 ff ff ff 58 c7 80 ff 2f 40 00 5c 2a 2e 2a c6 80 03 30 40 00 00 e9 67 02 00 00 } //00 00 
		$a_00_8 = {78 fe } //00 00 
	condition:
		any of ($a_*)
 
}
rule Ransom_Win32_Gulcrypt_B_2{
	meta:
		description = "Ransom:Win32/Gulcrypt.B,SIGNATURE_TYPE_PEHSTR_EXT,04 00 04 00 06 00 00 01 00 "
		
	strings :
		$a_01_0 = {3d 01 10 10 00 7d } //01 00 
		$a_03_1 = {8b c8 c7 45 90 01 01 11 01 10 00 89 55 90 00 } //01 00 
		$a_03_2 = {8d 45 f8 50 ff 75 90 01 01 ff 35 90 01 04 ff 35 90 01 04 e8 90 01 02 00 00 90 00 } //01 00 
		$a_03_3 = {89 45 fa 8b 85 bc fe ff ff 83 e0 10 0f 84 90 01 01 00 00 00 8d 85 e8 fe ff ff 50 68 90 01 04 e8 90 01 04 85 c0 0f 84 90 01 02 00 00 90 00 } //02 00 
		$a_03_4 = {5c 2a 2e 2a c6 80 90 01 04 00 e8 90 01 01 ff ff ff 58 c7 80 90 01 04 5c 2a 2e 2a c6 80 90 01 04 00 e9 90 01 02 00 00 8d 85 90 01 01 fe ff ff 50 e8 90 01 02 00 00 90 00 } //02 00 
		$a_03_5 = {bb 01 00 00 00 d3 e3 23 d8 74 90 01 01 80 c1 41 88 0d 90 01 04 80 e9 41 c7 05 90 01 04 3a 5c 2a 2e 90 02 01 c6 05 90 01 04 2a c6 05 90 01 04 00 50 51 e8 90 01 04 59 58 49 7d 90 09 05 00 b9 90 01 01 00 00 00 90 00 } //00 00 
	condition:
		any of ($a_*)
 
}