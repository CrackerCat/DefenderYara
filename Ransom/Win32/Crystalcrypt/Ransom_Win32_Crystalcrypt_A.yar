
rule Ransom_Win32_Crystalcrypt_A{
	meta:
		description = "Ransom:Win32/Crystalcrypt.A,SIGNATURE_TYPE_PEHSTR_EXT,1c 00 1c 00 1f 00 00 04 00 "
		
	strings :
		$a_01_0 = {43 52 59 53 54 41 4c 43 52 59 50 54 20 52 41 4e 53 4f 4d 57 41 52 45 21 0d 0a 0d 0a 41 4c 4c 20 59 4f 55 52 20 46 49 4c 45 53 20 48 41 56 45 20 42 45 45 4e 20 45 4e 43 52 59 50 54 45 44 } //04 00 
		$a_01_1 = {59 4f 55 20 42 45 43 41 4d 45 20 41 20 56 49 43 54 49 4d 20 4f 46 20 54 48 45 20 43 52 59 53 54 41 4c 43 52 59 50 54 20 52 41 4e 53 4f 4d 57 41 52 45 21 } //04 00  YOU BECAME A VICTIM OF THE CRYSTALCRYPT RANSOMWARE!
		$a_01_2 = {50 41 59 20 30 2e 31 37 20 42 49 54 43 4f 49 4e 53 20 54 4f 20 54 48 49 53 20 41 44 44 52 45 53 53 20 3a 20 31 4c 53 67 76 59 46 59 37 53 44 4e 6a 65 32 4d 68 73 6d 35 31 46 78 68 71 50 73 62 76 58 45 68 70 45 } //04 00  PAY 0.17 BITCOINS TO THIS ADDRESS : 1LSgvYFY7SDNje2Mhsm51FxhqPsbvXEhpE
		$a_01_3 = {59 4f 55 20 43 41 4e 20 46 49 4e 44 20 54 48 45 4d 20 4f 4e 20 59 4f 55 52 20 44 45 53 4b 54 4f 50 20 49 4e 20 22 43 52 59 53 54 41 4c 43 52 59 50 54 5f 55 4e 49 51 45 49 44 2e 54 58 54 22 } //04 00  YOU CAN FIND THEM ON YOUR DESKTOP IN "CRYSTALCRYPT_UNIQEID.TXT"
		$a_01_4 = {42 69 74 63 6f 69 6e 20 41 64 64 72 65 73 73 3a 20 31 34 6a 35 31 54 72 65 52 47 54 65 58 71 69 39 74 4a 38 77 43 61 66 33 57 73 65 62 31 4c 32 31 57 4d } //04 00  Bitcoin Address: 14j51TreRGTeXqi9tJ8wCaf3Wseb1L21WM
		$a_01_5 = {43 00 72 00 79 00 73 00 74 00 61 00 6c 00 43 00 72 00 79 00 70 00 74 00 5f 00 52 00 65 00 63 00 6f 00 76 00 65 00 72 00 5f 00 49 00 6e 00 73 00 74 00 75 00 63 00 74 00 69 00 6f 00 6e 00 73 00 2e 00 70 00 6e 00 67 00 } //01 00  CrystalCrypt_Recover_Instuctions.png
		$a_01_6 = {41 5f 44 72 69 76 65 } //01 00  A_Drive
		$a_01_7 = {42 5f 44 72 69 76 65 } //01 00  B_Drive
		$a_01_8 = {44 5f 44 72 69 76 65 } //01 00  D_Drive
		$a_01_9 = {45 5f 44 72 69 76 65 } //01 00  E_Drive
		$a_01_10 = {46 5f 44 72 69 76 65 } //01 00  F_Drive
		$a_01_11 = {47 5f 44 72 69 76 65 } //01 00  G_Drive
		$a_01_12 = {48 5f 44 72 69 76 65 } //01 00  H_Drive
		$a_01_13 = {49 5f 44 72 69 76 65 } //01 00  I_Drive
		$a_01_14 = {4a 5f 44 72 69 76 65 } //01 00  J_Drive
		$a_01_15 = {4b 5f 44 72 69 76 65 } //01 00  K_Drive
		$a_01_16 = {4c 5f 44 72 69 76 65 } //01 00  L_Drive
		$a_01_17 = {4d 5f 44 72 69 76 65 } //01 00  M_Drive
		$a_01_18 = {4e 5f 44 72 69 76 65 } //01 00  N_Drive
		$a_01_19 = {4f 5f 44 72 69 76 65 } //01 00  O_Drive
		$a_01_20 = {50 5f 44 72 69 76 65 } //01 00  P_Drive
		$a_01_21 = {51 5f 44 72 69 76 65 } //01 00  Q_Drive
		$a_01_22 = {52 5f 44 72 69 76 65 } //01 00  R_Drive
		$a_01_23 = {53 5f 44 72 69 76 65 } //01 00  S_Drive
		$a_01_24 = {54 5f 44 72 69 76 65 } //01 00  T_Drive
		$a_01_25 = {55 5f 44 72 69 76 65 } //01 00  U_Drive
		$a_01_26 = {56 5f 44 72 69 76 65 } //01 00  V_Drive
		$a_01_27 = {57 5f 44 72 69 76 65 } //01 00  W_Drive
		$a_01_28 = {58 5f 44 72 69 76 65 } //01 00  X_Drive
		$a_01_29 = {59 5f 44 72 69 76 65 } //01 00  Y_Drive
		$a_01_30 = {5a 5f 44 72 69 76 65 } //00 00  Z_Drive
	condition:
		any of ($a_*)
 
}